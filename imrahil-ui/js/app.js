!function(){"use strict";function e(e,t){e.setPrefix("smoothieApp"),t.setOptions({colours:["#FDB45C","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"],responsive:!0,maintainAspectRatio:!1})}function t(e,t,n,o){e.setCurrentLanguage(t.get("currentLanguage")||"en"),e.debug=!0,n.theme="bs3",n.activate="select"}angular.module("smoothieApp",["ui.bootstrap","gettext","ngSanitize","luegg.directives","xeditable","LocalStorageModule","ngFileUpload","chart.js"]).config(e).run(t),t.$inject=["gettextCatalog","localStorageService","editableOptions","$httpBackend"],e.$inject=["localStorageServiceProvider","ChartJsProvider"]}(),angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("de",{"Language:":"Sprache:"}),e.setStrings("pl",{Abort:"Przerwij","auto-check every:":"sprawdzaj co:",Autoscroll:"Autoscroll",Bed:"Stół",Clear:"Wyczyść",Commands:"Komendy",Controls:"Sterowanie",Delete:"Usuń","enable second extruder":"włącz drugi ekstruder",Extrude:"Wytłaczaj","Extruder T0":"Ekstruder T0","Extruder T1":"Ekstruder T1",Extruders:"Ekstrudery",Files:"Pliki","Filter temperatures":"Filtruj temperatury","Get temperature":"Sprawdź temperatury","Heater T0":"Głowica T0","Heater T1":"Głowica T1","Language:":"Język:","Motors off":"Wyłącz",Name:"Nazwa",Options:"Opcje",Print:"Drukuj",Progress:"Postęp",Refresh:"Odśwież",Reverse:"Cofnij",sec:"sek",Send:"Wyślij","Send Command...":"Wyślij polecenie",Settings:"Ustawienia","Speed:":"Prędkość:",Temperatures:"Temperatury",Upload:"Wczytaj","Value | Target":"Pomiar | Cel"})}]),function(){"use strict";function e(e,t){function n(){t.registerOutput(i)}function o(){i.command&&(console.log("Command: "+i.command),t.runCommand(i.command).then(function(e){i.updateOutput(e),i.cmdHistory.push(i.command),i.cmdHistory.slice(-300),i.cmdHistoryIdx=i.cmdHistory.length,i.command=""}))}function r(e){var t=e.keyCode;return 38==t||40==t?(38==t&&i.cmdHistory.length>0&&i.cmdHistoryIdx>0?i.cmdHistoryIdx--:40==t&&i.cmdHistoryIdx<i.cmdHistory.length-1&&i.cmdHistoryIdx++,i.cmdHistoryIdx>=0&&i.cmdHistoryIdx<i.cmdHistory.length&&(i.command=i.cmdHistory[i.cmdHistoryIdx]),!1):!0}function a(e){return 13==e.keyCode&&i.sendCommand(),!0}function l(){i.log=[],i.updateOutput()}function c(){i.updateOutput()}function u(e){i.log||(i.log=[]),e&&(i.log=i.log.concat(e),i.log=i.log.slice(-300));for(var t=/ok T:/g,n="",o=i.log.length,r=0;o>r;r++)i.filterOutput&&i.log[r].match(t)||(n+=i.log[r]);i.commandOutput=n}var i=this;i.log=[],i.command="",i.commandOutput="",i.cmdHistory=[],i.cmdHistoryIdx=-1,i.autoscrollEnabled=!0,i.filterOutput=!1,i.sendCommand=o,i.handleKeyDown=r,i.handleKeyUp=a,i.clear=l,i.onFilterChange=c,i.updateOutput=u,n()}angular.module("smoothieApp").controller("CommandCtrl",e),e.$inject=["$scope","DataService"]}(),function(){"use strict";function e(e){function t(){e.updateSecondExtruder()}function n(t,n){console.log("Extruder: "+t+" | length: "+o.filamenLength+" | speed: "+o.velocity),e.runCommand(t).then(function(e){console.log("Extruder result: "+e)}),e.runCommand("G91 G0 E"+o.filamenLength*n+" F"+o.velocity+" G90").then(function(e){console.log("Command result: "+e)})}var o=this;o.secondExtruder=e.secondExtruderState(),o.filamenLength=5,o.velocity=100,o.onSecondExtruderSupportChange=t,o.extrude=n}angular.module("smoothieApp").controller("ExtruderCtrl",e),e.$inject=["DataService"]}(),function(){"use strict";function e(e,t){function n(){o()}function o(){console.log("RefreshFiles"),e.runCommand("M20").then(function(e){r(e)},function(e){console.error(e.statusText)})}function r(e){s.fileList=[];var t=e.split("\n");angular.forEach(t,function(e,t){if(e=e.trim(),e.match(/\.g(code)?$/)){var n={filename:e,uploading:!1,percentage:0};s.fileList.push(n)}})}function a(t){console.log("print file - "+t),e.runCommand("play /sd/"+t).then(function(e){console.log("Result: "+e)})}function l(){e.runCommand("progress").then(function(t){e.broadcastCommand(t)},function(e){console.error(e.statusText)})}function c(){e.runCommand("abort").then(function(t){e.broadcastCommand(t)},function(e){console.error(e.statusText)})}function u(n){n&&(e.broadcastCommand("Uploading: "+n.name+"\n"),s.currentUploadedFile={filename:n.name,uploading:!0,percentage:0},s.fileList.push(s.currentUploadedFile),t.http({url:"/upload",headers:{"X-Filename":n.name},data:n}).then(function(t){e.broadcastCommand("Upload successful. Response: "+t.data),s.currentUploadedFile.uploading=!1,s.refreshFiles()},function(t){e.broadcastCommand("Error status: "+t.status+"\n")},function(e){var t=parseInt(100*e.loaded/e.total);s.currentUploadedFile.percentage=t,console.log("Progress: "+t+"%")}))}function i(t){e.runCommand("M30 "+t.filename).then(function(n){e.broadcastCommand("Deleted file: "+t.filename+"\n"),s.refreshFiles()},function(e){console.error(e.statusText)})}var s=this;s.fileList=[],s.currentUploadedFile={},s.refreshFiles=o,s.print=a,s.progress=l,s.abort=c,s.uploadFile=u,s.deleteFile=i,n()}angular.module("smoothieApp").controller("FileCtrl",e),e.$inject=["DataService","Upload"]}(),function(){"use strict";function e(e,t){function n(n){r.languages.current=n,e.setCurrentLanguage(n),t.set("currentLanguage",r.languages.current)}function o(){t.set("printerName",r.printerName)}var r=this;r.printerName=t.get("printerName")||"Your printer name",r.languages={current:e.currentLanguage,available:{en:"English",pl:"Polski"}},r.setLanguage=n,r.updatePrinterName=o}angular.module("smoothieApp").controller("HeaderCtrl",e),e.$inject=["gettextCatalog","localStorageService"]}(),function(){"use strict";function e(e){function t(e){console.log("Home axis: "+e)}function n(){console.log("MotorsOff"),e.runCommand("M18").then(function(e){console.log("Motors turned off! - Result: "+e)},function(e){console.error(e.statusText)})}function o(t){console.log("jogButtonClick - "+t),e.runCommand(t).then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}function r(t){console.log("jogXYClick - "+t),e.runCommand("G91 G0 "+t+" F"+l.xy_velocity+" G90").then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}function a(t){console.log("jogZClick - "+t),e.runCommand("G91 G0 "+t+" F"+l.z_velocity+" G90").then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}var l=this;l.elementId="",l.xy_velocity=3e3,l.z_velocity=200,l.homeAxis=t,l.motorsOff=n,l.jogButtonClick=o,l.jogXYClick=r,l.jogZClick=a}angular.module("smoothieApp").controller("MotorCtrl",e),e.$inject=["DataService"]}(),function(){"use strict";function e(e,t,n){function o(){d.autoCheckEnabled&&(d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval),d.getTemperatures())}function r(){d.getTemperatures()}function a(e){switch(console.log("HeatOff - heater: "+e),e){case"T0":d.heaterT0SelectedTemp=0;break;case"T1":d.heaterT1SelectedTemp=0;break;case"bed":d.bedSelectedTemp=0}var n="bed"!=e,o=n?104:140,r="M"+o+" S0";n&&(r+=" "+e),t.runCommand(r).then(function(e){d.getTemperatures()})}function l(e){console.log("HeatSet - heater: "+e);var n=0;switch(e){case"T0":n=d.heaterT0SelectedTemp;break;case"T1":n=d.heaterT1SelectedTemp;break;case"bed":n=d.bedSelectedTemp}console.log("Temp: "+n);var o="bed"!=e,r=o?104:140,a="M"+r+" S"+n;o&&(a+=" "+e),t.runCommand(a).then(function(e){d.getTemperatures()})}function c(e,t){return 13==e.keyCode&&d.heatSet(t),!0}function u(){d.autoCheckEnabled?(d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval),n.set("autoCheckEnabled","true"),d.getTemperatures()):(angular.isDefined(d.localTempInterval)&&e.cancel(d.localTempInterval),n.set("autoCheckEnabled","false"))}function i(){n.set("tempInterval",d.tempInterval),angular.isDefined(d.localTempInterval)&&e.cancel(d.localTempInterval),d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval)}function s(){t.runCommand("M105").then(function(e){t.broadcastCommand(e);for(var n,o=/(B|T(\d*)):\s*([+]?[0-9]*\.?[0-9]+)? (\/)([+]?[0-9]*\.?[0-9]+)?/gi;null!==(n=o.exec(e));){var r=n[1],a=n[3]+"°C";a+=" | "+n[5]+"°C","T"==r?(d.heaterT0ActualTemp=n[3],d.heaterT0DisplayTemp=a):"T1"==r&&(d.heaterT1ActualTemp=n[3],d.heaterT1DisplayTemp=a),"B"==r&&(d.bedActualTemp=Number(n[3]),d.bedDisplayTemp=a)}for(d.labels.length&&(d.labels=d.labels.slice(1),d.dataHeater[0]=d.dataHeater[0].slice(1),d.dataBed[0]=d.dataBed[0].slice(1));d.labels.length<20;)d.labels.push(""),d.dataHeater[0].push(d.heaterT0ActualTemp),d.dataBed[0].push(d.bedActualTemp)},function(e){console.error(e.statusText)})}var d=this;d.secondExtruder=t.secondExtruderState(),d.labels=[],d.seriesHeater=["Heater T0"],d.dataHeater=[[]],d.heaterColours=["#4D5360"],d.seriesBed=["Bed"],d.dataBed=[[]],d.bedColours=["#F7464A"],d.options={animation:!1,showScale:!0,showTooltips:!1,pointDot:!1,datasetStrokeWidth:.5,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="<%=name.toLowerCase()%>-legend-icon" style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},d.localTempInterval={},d.tempInterval=n.get("tempInterval")||3,d.autoCheckEnabled="true"==n.get("autoCheckEnabled"),d.heaterT0SelectedTemp=0,d.heaterT0ActualTemp="-",d.heaterT0DisplayTemp="",d.heaterT1SelectedTemp=0,d.heaterT1ActualTemp="-",d.heaterT1DisplayTemp="",d.bedSelectedTemp=0,d.bedActualTemp="-",d.bedDisplayTemp="",d.onTimeout=r,d.heatOff=a,d.heatSet=l,d.handleKeyUp=c,d.onAutoCheckChange=u,d.onTempIntervalChange=i,d.getTemperatures=s,o()}angular.module("smoothieApp").controller("TempCtrl",e),e.$inject=["$interval","DataService","localStorageService"]}(),function(){"use strict";function e(e,t){function n(t){return t+="\n",e.post(c,t).then(function(e){return e.data})}function o(e){i.push(e)}function r(e){for(var t=0;t<i.length;++t)i[t].updateOutput(e)}function a(){return u}function l(){t.set("secondExtruderSupportEnabled",u.supportEnabled?"true":"false")}var c="/command",u={supportEnabled:"true"==t.get("secondExtruderSupportEnabled")},i=[],s={runCommand:n,registerOutput:o,broadcastCommand:r,secondExtruderState:a,updateSecondExtruder:l};return s}angular.module("smoothieApp").factory("DataService",e),e.$inject=["$http","localStorageService"]}(),function(e,t){"use strict";function n(e,n,o){function r(e){var t=e;return{getValue:function(){return t},setValue:function(e){t=e}}}function a(e,t){return{getValue:function(){return e(t)},setValue:function(){}}}function l(e,t,n){return{getValue:function(){return e(n)},setValue:function(o){o!==e(n)&&n.$apply(function(){t(n,o)})}}}if(""!==n){var c=e(n);return c.assign!==t?l(c,c.assign,o):a(c,o)}return r(!0)}function o(e,t,o){e.directive(t,["$parse","$window","$timeout",function(e,r,a){return{priority:1,restrict:"A",link:function(l,c,u){function i(){d.getValue()&&!o.isAttached(s)&&o.scroll(s)}var s=c[0],d=n(e,u[t],l);l.$watch(i),a(i,0,!1),r.addEventListener("resize",i,!1),c.bind("scroll",function(){d.setValue(o.isAttached(s))})}}}])}var r={isAttached:function(e){return e.scrollTop+e.clientHeight+1>=e.scrollHeight},scroll:function(e){e.scrollTop=e.scrollHeight}},a={isAttached:function(e){return e.scrollTop<=1},scroll:function(e){e.scrollTop=0}},l={isAttached:function(e){return e.scrollLeft+e.clientWidth+1>=e.scrollWidth},scroll:function(e){e.scrollLeft=e.scrollWidth}},c={isAttached:function(e){return e.scrollLeft<=1},scroll:function(e){e.scrollLeft=0}},u=e.module("luegg.directives",[]);o(u,"scrollGlue",r),o(u,"scrollGlueTop",a),o(u,"scrollGlueBottom",r),o(u,"scrollGlueLeft",c),o(u,"scrollGlueRight",l)}(angular);