!function(){"use strict";function e(e,t){e.setPrefix("smoothieApp"),t.setOptions({colours:["#FDB45C","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"],responsive:!0,maintainAspectRatio:!1})}function t(e,t,r,n){e.setCurrentLanguage(t.get("currentLanguage")||"en"),e.debug=!0,r.theme="bs3",r.activate="select"}angular.module("smoothieApp",["ui.bootstrap","gettext","ngSanitize","luegg.directives","xeditable","LocalStorageModule","ngFileUpload","chart.js"]).config(e).run(t),t.$inject=["gettextCatalog","localStorageService","editableOptions","$httpBackend"],e.$inject=["localStorageServiceProvider","ChartJsProvider"]}(),angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("de",{"Language:":"Sprache:"}),e.setStrings("pl",{Abort:"Przerwij","auto-check every:":"sprawdzaj co:",Autoscroll:"Autoscroll",Bed:"Stół",Clear:"Wyczyść",Commands:"Komendy",Controls:"Sterowanie",Delete:"Usuń","enable second extruder":"włącz drugi ekstruder",Extrude:"Wytłaczaj","Extruder T0":"Ekstruder T0","Extruder T1":"Ekstruder T1",Extruders:"Ekstrudery",Files:"Pliki","Filter temperatures":"Filtruj temperatury","Get temperature":"Sprawdź temperatury","Heater T0":"Głowica T0","Heater T1":"Głowica T1","Language:":"Język:","Motors off":"Wyłącz",Name:"Nazwa",Options:"Opcje",Print:"Drukuj",Progress:"Postęp",Refresh:"Odśwież",Reverse:"Cofnij",sec:"sek",Send:"Wyślij","Send Command...":"Wyślij polecenie",Settings:"Ustawienia","Speed:":"Prędkość:",Temperatures:"Temperatury",Upload:"Wczytaj","Value | Target":"Pomiar | Cel"})}]),function(){"use strict";function e(e,t){function r(){t.registerOutput(u)}function n(){u.command&&(console.log("Command: "+u.command),t.runCommand(u.command).then(function(e){u.updateOutput(e),u.cmdHistory.push(u.command),u.cmdHistory.slice(-300),u.cmdHistoryIdx=u.cmdHistory.length,u.command=""}))}function o(e){var t=e.keyCode;return 38==t||40==t?(38==t&&u.cmdHistory.length>0&&u.cmdHistoryIdx>0?u.cmdHistoryIdx--:40==t&&u.cmdHistoryIdx<u.cmdHistory.length-1&&u.cmdHistoryIdx++,u.cmdHistoryIdx>=0&&u.cmdHistoryIdx<u.cmdHistory.length&&(u.command=u.cmdHistory[u.cmdHistoryIdx]),!1):!0}function a(e){return 13==e.keyCode&&u.sendCommand(),!0}function c(){u.log=[],u.updateOutput()}function l(){u.updateOutput()}function i(e){u.log||(u.log=[]),e&&(u.log=u.log.concat(e),u.log=u.log.slice(-300));for(var t=/ok T:/g,r="",n=u.log.length,o=0;n>o;o++)u.filterOutput&&u.log[o].match(t)||(r+=u.log[o]);u.commandOutput=r}var u=this;u.log=[],u.command="",u.commandOutput="",u.cmdHistory=[],u.cmdHistoryIdx=-1,u.autoscrollEnabled=!0,u.filterOutput=!1,u.sendCommand=n,u.handleKeyDown=o,u.handleKeyUp=a,u.clear=c,u.onFilterChange=l,u.updateOutput=i,r()}angular.module("smoothieApp").controller("CommandCtrl",e),e.$inject=["$scope","DataService"]}(),function(){"use strict";function e(e){function t(){e.updateSecondExtruder()}function r(t,r){console.log("Extruder: "+t+" | length: "+n.filamenLength+" | speed: "+n.velocity),e.runCommand(t).then(function(e){console.log("Extruder result: "+e)}),e.runCommand("G91 G0 E"+n.filamenLength*r+" F"+n.velocity+" G90").then(function(e){console.log("Command result: "+e)})}var n=this;n.secondExtruder=e.secondExtruderState(),n.filamenLength=5,n.velocity=100,n.onSecondExtruderSupportChange=t,n.extrude=r}angular.module("smoothieApp").controller("ExtruderCtrl",e),e.$inject=["DataService"]}(),function(){"use strict";function e(e,t){function r(){n()}function n(){console.log("RefreshFiles"),e.runCommand("M20").then(function(e){o(e)},function(e){console.error(e.statusText)})}function o(e){s.fileList=[];var t=e.split("\n");angular.forEach(t,function(e,t){if(e=e.trim(),e.match(/\.g(code)?$/)){var r={filename:e,uploading:!1,percentage:0};s.fileList.push(r)}})}function a(t){console.log("print file - "+t),e.runCommand("play /sd/"+t).then(function(e){console.log("Result: "+e)})}function c(){e.runCommand("progress").then(function(t){e.broadcastCommand(t)},function(e){console.error(e.statusText)})}function l(){e.runCommand("abort").then(function(t){e.broadcastCommand(t)},function(e){console.error(e.statusText)})}function i(r){r&&(e.broadcastCommand("Uploading: "+r.name+"\n"),s.currentUploadedFile={filename:r.name,uploading:!0,percentage:0},s.fileList.push(s.currentUploadedFile),t.http({url:"/upload",headers:{"X-Filename":r.name},data:r}).then(function(t){e.broadcastCommand("Upload successful. Response: "+t.data),s.currentUploadedFile.uploading=!1,s.refreshFiles()},function(t){e.broadcastCommand("Error status: "+t.status+"\n")},function(e){var t=parseInt(100*e.loaded/e.total);s.currentUploadedFile.percentage=t,console.log("Progress: "+t+"%")}))}function u(t){e.runCommand("M30 "+t.filename).then(function(r){e.broadcastCommand("Deleted file: "+t.filename+"\n"),s.refreshFiles()},function(e){console.error(e.statusText)})}var s=this;s.fileList=[],s.currentUploadedFile={},s.refreshFiles=n,s.print=a,s.progress=c,s.abort=l,s.uploadFile=i,s.deleteFile=u,r()}angular.module("smoothieApp").controller("FileCtrl",e),e.$inject=["DataService","Upload"]}(),function(){"use strict";function e(e,t){function r(r){o.languages.current=r,e.setCurrentLanguage(r),t.set("currentLanguage",o.languages.current)}function n(){t.set("printerName",o.printerName)}var o=this;o.printerName=t.get("printerName")||"Your printer name",o.languages={current:e.currentLanguage,available:{en:"English",pl:"Polski"}},o.setLanguage=r,o.updatePrinterName=n}angular.module("smoothieApp").controller("HeaderCtrl",e),e.$inject=["gettextCatalog","localStorageService"]}(),function(){"use strict";function e(e){function t(e){console.log("Home axis: "+e)}function r(){console.log("MotorsOff"),e.runCommand("M18").then(function(e){console.log("Motors turned off! - Result: "+e)},function(e){console.error(e.statusText)})}function n(t){console.log("jogButtonClick - "+t),e.runCommand(t).then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}function o(t){console.log("jogXYClick - "+t),e.runCommand("G91 G0 "+t+" F"+c.xy_velocity+" G90").then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}function a(t){console.log("jogZClick - "+t),e.runCommand("G91 G0 "+t+" F"+c.z_velocity+" G90").then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}var c=this;c.elementId="",c.xy_velocity=3e3,c.z_velocity=200,c.homeAxis=t,c.motorsOff=r,c.jogButtonClick=n,c.jogXYClick=o,c.jogZClick=a}angular.module("smoothieApp").controller("MotorCtrl",e),e.$inject=["DataService"]}(),function(){"use strict";function e(e,t,r){function n(){d.autoCheckEnabled&&(d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval),d.getTemperatures())}function o(){d.getTemperatures()}function a(e){switch(console.log("HeatOff - heater: "+e),e){case"T0":d.heaterT0SelectedTemp=0;break;case"T1":d.heaterT1SelectedTemp=0;break;case"bed":d.bedSelectedTemp=0}var r="bed"!=e,n=r?104:140,o="M"+n+" S0";r&&(o+=" "+e),t.runCommand(o).then(function(e){d.getTemperatures()})}function c(e){console.log("HeatSet - heater: "+e);var r=0;switch(e){case"T0":r=d.heaterT0SelectedTemp;break;case"T1":r=d.heaterT1SelectedTemp;break;case"bed":r=d.bedSelectedTemp}console.log("Temp: "+r);var n="bed"!=e,o=n?104:140,a="M"+o+" S"+r;n&&(a+=" "+e),t.runCommand(a).then(function(e){d.getTemperatures()})}function l(e,t){return 13==e.keyCode&&d.heatSet(t),!0}function i(){d.autoCheckEnabled?(d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval),r.set("autoCheckEnabled","true"),d.getTemperatures()):(angular.isDefined(d.localTempInterval)&&e.cancel(d.localTempInterval),r.set("autoCheckEnabled","false"))}function u(){r.set("tempInterval",d.tempInterval),angular.isDefined(d.localTempInterval)&&e.cancel(d.localTempInterval),d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval)}function s(){t.runCommand("M105").then(function(e){t.broadcastCommand(e);for(var r,n=/(B|T(\d*)):\s*([+]?[0-9]*\.?[0-9]+)? (\/)([+]?[0-9]*\.?[0-9]+)?/gi;null!==(r=n.exec(e));){var o=r[1],a=r[3]+"°C";a+=" | "+r[5]+"°C","T"==o?(d.heaterT0ActualTemp=r[3],d.heaterT0DisplayTemp=a):"T1"==o&&(d.heaterT1ActualTemp=r[3],d.heaterT1DisplayTemp=a),"B"==o&&(d.bedActualTemp=Number(r[3]),d.bedDisplayTemp=a)}for(d.labels.length&&(d.labels=d.labels.slice(1),d.dataHeater[0]=d.dataHeater[0].slice(1),d.dataBed[0]=d.dataBed[0].slice(1));d.labels.length<20;)d.labels.push(""),d.dataHeater[0].push(d.heaterT0ActualTemp),d.dataBed[0].push(d.bedActualTemp)},function(e){console.error(e.statusText)})}var d=this;d.secondExtruder=t.secondExtruderState(),d.labels=[],d.seriesHeater=["Heater T0"],d.dataHeater=[[]],d.heaterColours=[{backgroundColor:"rgba(77, 83, 96, 0.2)",borderColor:"rgba(77, 83, 96, 0.5)"}],d.seriesBed=["Bed"],d.dataBed=[[]],d.bedColours=[{backgroundColor:"rgba(247, 70, 74, 0.2)",borderColor:"rgba(247, 70, 74, 0.5)"}],Chart.defaults.global.elements.point.radius=0,Chart.defaults.global.legend.position="bottom",Chart.defaults.global.animation.duration=0,Chart.defaults.global.elements.line.borderWidth=1,d.options={tooltips:{enabled:!1},scales:{xAxes:[{gridLines:{display:!1}}]}},d.localTempInterval={},d.tempInterval=r.get("tempInterval")||3,d.autoCheckEnabled="true"==r.get("autoCheckEnabled"),d.heaterT0SelectedTemp=0,d.heaterT0ActualTemp="-",d.heaterT0DisplayTemp="",d.heaterT1SelectedTemp=0,d.heaterT1ActualTemp="-",d.heaterT1DisplayTemp="",d.bedSelectedTemp=0,d.bedActualTemp="-",d.bedDisplayTemp="",d.onTimeout=o,d.heatOff=a,d.heatSet=c,d.handleKeyUp=l,d.onAutoCheckChange=i,d.onTempIntervalChange=u,d.getTemperatures=s,n()}angular.module("smoothieApp").controller("TempCtrl",e),e.$inject=["$interval","DataService","localStorageService"]}(),function(){"use strict";function e(e,t){function r(t){return t+="\n",e.post(l,t).then(function(e){return e.data})}function n(e){u.push(e)}function o(e){for(var t=0;t<u.length;++t)u[t].updateOutput(e)}function a(){return i}function c(){t.set("secondExtruderSupportEnabled",i.supportEnabled?"true":"false")}var l="/command",i={supportEnabled:"true"==t.get("secondExtruderSupportEnabled")},u=[],s={runCommand:r,registerOutput:n,broadcastCommand:o,secondExtruderState:a,updateSecondExtruder:c};return s}angular.module("smoothieApp").factory("DataService",e),e.$inject=["$http","localStorageService"]}(),function(e,t){"use strict";function r(e,r,n){function o(e){var t=e;return{getValue:function(){return t},setValue:function(e){t=e}}}function a(e,t){return{getValue:function(){return e(t)},setValue:function(){}}}function c(e,t,r){return{getValue:function(){return e(r)},setValue:function(n){n!==e(r)&&r.$apply(function(){t(r,n)})}}}if(""!==r){var l=e(r);return l.assign!==t?c(l,l.assign,n):a(l,n)}return o(!0)}function n(e,t,n){e.directive(t,["$parse","$window","$timeout",function(e,o,a){return{priority:1,restrict:"A",link:function(c,l,i){function u(){f.getValue()&&!n.isAttached(d)&&n.scroll(d)}function s(){f.setValue(n.isAttached(d))}var d=l[0],f=r(e,i[t],c);c.$watch(u),a(u,0,!1),o.addEventListener("resize",u,!1),l.bind("scroll",s),l.on("$destroy",function(){l.unbind("scroll",s)}),c.$on("$destroy",function(){o.removeEventListener("resize",u,!1)})}}}])}var o={isAttached:function(e){return e.scrollTop+e.clientHeight+1>=e.scrollHeight},scroll:function(e){e.scrollTop=e.scrollHeight}},a={isAttached:function(e){return e.scrollTop<=1},scroll:function(e){e.scrollTop=0}},c={isAttached:function(e){return e.scrollLeft+e.clientWidth+1>=e.scrollWidth},scroll:function(e){e.scrollLeft=e.scrollWidth}},l={isAttached:function(e){return e.scrollLeft<=1},scroll:function(e){e.scrollLeft=0}},i=e.module("luegg.directives",[]);n(i,"scrollGlue",o),n(i,"scrollGlueTop",a),n(i,"scrollGlueBottom",o),n(i,"scrollGlueLeft",l),n(i,"scrollGlueRight",c)}(angular),!function(e){"use strict";if("object"==typeof exports)module.exports=e("undefined"!=typeof angular?angular:require("angular"),"undefined"!=typeof Chart?Chart:require("chart.js"));else if("function"==typeof define&&define.amd)define(["angular","chart"],e);else{if("undefined"==typeof angular||"undefined"==typeof Chart)throw new Error("Chart.js library needs to included, see http://jtblin.github.io/angular-chart.js/");e(angular,Chart)}}(function(e,t){"use strict";function r(){var r={responsive:!0},n={Chart:t,getOptions:function(t){var n=t&&r[t]||{};return e.extend({},r,n)}};this.setOptions=function(t,n){return n?void(r[t]=e.extend(r[t]||{},n)):(n=t,void(r=e.extend(r,n)))},this.$get=function(){return n}}function n(r,n){function a(e,t,n){var o=T(e,t);if(g(t)&&A(e,t,n,o)){var a=n[0],c=a.getContext("2d");t.chartGetColor=C(t);var l=v(e,t);D(t),t.chart=new r.Chart(c,{type:e,data:l,options:o}),t.$emit("chart-create",t.chart),x(a,t)}}function c(e,t){return e&&t&&e.length&&t.length?Array.isArray(e[0])?e.length===t.length&&e.every(function(e,r){return e.length===t[r].length}):t.reduce(l,0)>0?e.length===t.length:!1:!1}function l(e,t){return e+t}function i(t,r,n){var o=null;return function(a){var c=t.chart.getElementsAtEvent||t.chart.getPointsAtEvent;if(c){var l=c.call(t.chart,a);n!==!1&&e.equals(o,l)!==!1||(o=l,t[r](l,a))}}}function u(n,o){for(var a=e.copy(o.chartColors||r.getOptions(n).chartColors||t.defaults.global.colors),c=a.length<o.chartData.length;a.length<o.chartData.length;)a.push(o.chartGetColor());return c&&(o.chartColors=a),a.map(s)}function s(e){return"object"==typeof e&&null!==e?e:"string"==typeof e&&"#"===e[0]?f(p(e.substr(1))):d()}function d(){var e=[h(0,255),h(0,255),h(0,255)];return f(e)}function f(e){return{backgroundColor:m(e,.2),pointBackgroundColor:m(e,1),pointHoverBackgroundColor:m(e,.8),borderColor:m(e,1),pointBorderColor:"#fff",pointHoverBorderColor:m(e,1)}}function h(e,t){return Math.floor(Math.random()*(t-e+1))+e}function m(e,t){return o?"rgb("+e.join(",")+")":"rgba("+e.concat(t).join(",")+")"}function p(e){var t=parseInt(e,16),r=t>>16&255,n=t>>8&255,o=255&t;return[r,n,o]}function g(e){return e.chartData&&e.chartData.length}function C(e){return"function"==typeof e.chartGetColor?e.chartGetColor:d}function v(e,t){var r=u(e,t);return Array.isArray(t.chartData[0])?b(t.chartLabels,t.chartData,t.chartSeries||[],r,t.chartDatasetOverride):y(t.chartLabels,t.chartData,r,t.chartDatasetOverride)}function b(t,r,n,o,a){return{labels:t,datasets:r.map(function(t,r){var c=e.extend({},o[r],{label:n[r],data:t});return a&&a.length>=r&&e.merge(c,a[r]),c})}}function y(t,r,n,o){var a={labels:t,datasets:[{data:r,backgroundColor:n.map(function(e){return e.pointBackgroundColor}),hoverBackgroundColor:n.map(function(e){return e.backgroundColor})}]};return o&&e.merge(a.datasets[0],o),a}function T(t,n){return e.extend({},r.getOptions(t),n.chartOptions)}function x(t,r){t.onclick=r.chartClick?i(r,"chartClick",!1):e.noop,t.onmousemove=r.chartHover?i(r,"chartHover",!0):e.noop}function S(e,t){Array.isArray(t.chartData[0])?t.chart.data.datasets.forEach(function(t,r){t.data=e[r]}):t.chart.data.datasets[0].data=e,t.chart.update(),t.$emit("chart-update",t.chart)}function k(e){return!e||Array.isArray(e)&&!e.length||"object"==typeof e&&!Object.keys(e).length}function A(e,t,r,o){return o.responsive&&0===r[0].clientHeight?(n(function(){a(e,t,r)},50,!1),!1):!0}function D(e){e.chart&&(e.chart.destroy(),e.$emit("chart-destroy",e.chart))}return function(t){return{restrict:"CA",scope:{chartGetColor:"=?",chartType:"=",chartData:"=?",chartLabels:"=?",chartOptions:"=?",chartSeries:"=?",chartColors:"=?",chartClick:"=?",chartHover:"=?",chartDatasetOverride:"=?"},link:function(r,n){function l(e,o){if(!e||!e.length||Array.isArray(e[0])&&!e[0].length)return void D(r);var l=t||r.chartType;return l?r.chart&&c(e,o)?S(e,r):void a(l,r,n):void 0}function i(o,c){if(!k(o)&&!e.equals(o,c)){var l=t||r.chartType;l&&a(l,r,n)}}function u(t,o){k(t)||e.equals(t,o)||a(t,r,n)}o&&window.G_vmlCanvasManager.initElement(n[0]),r.$watch("chartData",l,!0),r.$watch("chartSeries",i,!0),r.$watch("chartLabels",i,!0),r.$watch("chartOptions",i,!0),r.$watch("chartColors",i,!0),r.$watch("chartDatasetOverride",i,!0),r.$watch("chartType",u,!1),r.$on("$destroy",function(){D(r)}),r.$on("$resize",function(){r.chart&&r.chart.resize()})}}}}t.defaults.global.multiTooltipTemplate="<%if (datasetLabel){%><%=datasetLabel%>: <%}%><%= value %>",t.defaults.global.tooltips.mode="label",t.defaults.global.elements.line.borderWidth=2,t.defaults.global.elements.rectangle.borderWidth=2,t.defaults.global.legend.display=!1,t.defaults.global.colors=["#97BBCD","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"];var o="object"==typeof window.G_vmlCanvasManager&&null!==window.G_vmlCanvasManager&&"function"==typeof window.G_vmlCanvasManager.initElement;return o&&(t.defaults.global.animation=!1),e.module("chart.js",[]).provider("ChartJs",r).factory("ChartJsFactory",["ChartJs","$timeout",n]).directive("chartBase",["ChartJsFactory",function(e){return new e}]).directive("chartLine",["ChartJsFactory",function(e){return new e("line")}]).directive("chartBar",["ChartJsFactory",function(e){return new e("bar")}]).directive("chartHorizontalBar",["ChartJsFactory",function(e){return new e("horizontalBar")}]).directive("chartRadar",["ChartJsFactory",function(e){return new e("radar")}]).directive("chartDoughnut",["ChartJsFactory",function(e){return new e("doughnut")}]).directive("chartPie",["ChartJsFactory",function(e){return new e("pie")}]).directive("chartPolarArea",["ChartJsFactory",function(e){return new e("polarArea")}]).directive("chartBubble",["ChartJsFactory",function(e){return new e("bubble")}]).name});